library(circlize)
# Define the botanical names and habits
botanical_names <- c("Acorus calamus", "Nardostachys grandiflora", "Ageratum conyzoides", "Artemisia indica", "Eupatorium adenophorum", "Fagopyrum dibotrys", "Cyathocline purpurea", "Bidens pilosa", "Astilbe rivularis", "Bauhinia vahlii", "Cardamine hirsuta", "Schima wallichii", "Ocimum tenuiflorum", "Aloe vera", "Cannabis sativa", "Drymaria diandra", "Rubia manjith", "Swertia chirata", "Abrus precatorius", "Rubia cordifolia", "Garcinia cowa", "Ficus benjamina", "Ficus religiosa", "Ficus benghalensis", "Ficus auriculata", "Ficus semicordata", "Artocarpus heterophyllus", "Morus australis", "Osbeckia crinita", "Nephrolepis tuberosa", "Colocasia esculenta", "Diplazium esculentum", "Bergenia ciliata", "Curcuma longa", "Zanthoxylum armatum", "Piper mullesua", "Girardinia diversifolia", "Elatostema lineolatum", "Rubus ellipticus", "Prunus persica", "Oroxylum indicum", "Phytolacca acinosa", "Lindernia anagallis", "Lobelia nummularia", "Mangifera indica", "Phyllanthus emblica", "Euphorbia hirta", "Piper longum", "Ziziphus mauritiana", "Momordica charantia", "Dioscorea bulbifera", "Entada pursaetha", "Tamarindus indica", "Juglans regia", "Moringa oleifera", "Picrorhiza kurroa", "Cynodon dactylon", "Punica granatum", "Amomum subulatum", "Alnus nepalensis", "Zingiber officinate", "Senna tora", "Selaginella delicatula", "Choerospondias axillaris", "Rhus chinensis", "Aquilaria malaccensis", "Cinnamomum tamala", "Bauhinia variegata", "Mentha spicata", "Oxalis corniculata", "Rumex nepalensis")
uses <- c("Skin Diseases, Respiratory Issues, Dental Problems, Headaches and Pain", "Fever and Infections, Headaches and Pain, Respiratory Issues", "Injuries and Bleeding", "Injuries and Bleeding", "Injuries and Bleeding", "Digestive Disorders, Allergic Reactions", "Digestive Disorders", "Injuries and Bleeding, Eye and Ear Problems, Digestive Disorders", "Fever and Infections, Digestive Disorders, Respiratory Issues, Headaches and Pain, Injuries and Bleeding, Blood-related Disorders, Dental Problems", "Digestive Disorders", "Cardiovascular Disorders", "Fever and Infections, Digestive Disorders, Injuries and Bleeding", "Fever and Infections, Digestive Disorders, Skin Diseases, Eye and Ear Problems, Insect and Animal Bites, Respiratory Issues, Dental Problems", "Skin Diseases, Injuries and Bleeding, Women's Health Issues, Fever and Infections", "Digestive Disorders, Eye and Ear Problems, Miscellaneous", "Respiratory Issues", "Respiratory Issues, Women's Health Issues, Insect and Animal Bites, Skin Diseases", "Fever and Infections, Headaches and Pain, Digestive Disorders, Respiratory Issues, Injuries and Bleeding, Skin Diseases", "Eye and Ear Problems", "Blood-related Disorders, Allergic Reactions", "Fever and Infections, Digestive Disorders", "Skin Diseases", "Respiratory Issues, Eye and Ear Problems, Dental Problems, Headaches and Pain, Injuries and Bleeding", "Digestive Disorders, Headaches and Pain, Injuries and Bleeding, Respiratory Issues, Insect and Animal Bites, Dental Problems, Women's Health Issues", "Digestive Disorders", "Skin Diseases, Injuries and Bleeding", "Skin Diseases, Injuries and Bleeding", "Respiratory Issues, Injuries and Bleeding", "Digestive Disorders, Dental Problems", "Urinary and Kidney Issues", "Injuries and Bleeding", "Cardiovascular Disorders", "Digestive Disorders, Cardiovascular Disorders, Injuries and Bleeding, Skin Diseases, Headaches and Pain, Respiratory Issues, Eye and Ear Problems, Fever and Infections", "Digestive Disorders, Respiratory Issues, Injuries and Bleeding", "Digestive Disorders", "Respiratory Issues", "Digestive Disorders, Allergic Reactions, Headaches and Pain", "Injuries and Bleeding", "Fever and Infections, Digestive Disorders, Respiratory Issues", "Digestive Disorders, Injuries and Bleeding, Miscellaneous", "Fever and Infections, Digestive Disorders, Miscellaneous", "Skin Diseases, Injuries and Bleeding, Urinary and Kidney Issues", "Miscellaneous", "Women's Health Issues, Digestive Disorders, Skin Diseases, Allergic Reactions, Eye and Ear Problems", "Respiratory Issues, Digestive Disorders", "Respiratory Issues, Fever and Infections, Urinary and Kidney Issues, Eye and Ear Problems, Digestive Disorders", "Digestive Disorders, Skin Diseases, Injuries and Bleeding", "Respiratory Issues", "Digestive Disorders", "Blood-related Disorders, Miscellaneous, Injuries and Bleeding, Digestive Disorders", "Digestive Disorders", "Skin Diseases, Miscellaneous", "Respiratory Issues, Digestive Disorders", "Respiratory Issues, Injuries and Bleeding, Headaches and Pain", "Cardiovascular Disorders, Respiratory Issues", "Injuries and Bleeding, Respiratory Issues", "Skin Diseases, Injuries and Bleeding, Miscellaneous, Digestive Disorders", "Fever and Infections, Cardiovascular Disorders, Respiratory Issues, Digestive Disorders", "Digestive Disorders, Dental Problems, Insect and Animal Bites", "Digestive Disorders, Injuries and Bleeding", "Cardiovascular Disorders, Respiratory Issues, Headaches and Pain", "Miscellaneous, Skin Diseases, Insect and Animal Bites", "Injuries and Bleeding", "Injuries and Bleeding, Miscellaneous", "Digestive Disorders", "Cardiovascular Disorders, Miscellaneous", "Respiratory Issues, Allergic Reactions, Digestive Disorders", "Skin Diseases, Digestive Disorders", "Digestive Disorders, Miscellaneous, Fever and Infections, Respiratory Issues", "Respiratory Issues, Fever and Infections, Insect and Animal Bites, Digestive Disorders", "Blood-related Disorders, Allergic Reactions, Fever and Infections")
# Separate multiple uses for each botanical name
data <- data.frame(BotanicalName = botanical_names, Uses = uses)
data <- separate_rows(data, Uses, sep = ", ")

# Define a color palette for the 15 categories of uses
use_colors <- c("red", "blue", "green", "yellow", "#000080", "orange", "#B8860B", "brown", "cyan", "magenta", "#008080", "#98FB98", "#9400D3", "#FF6347", "black")

# Assign colors to each unique use
unique_uses <- unique(data$Uses)
use_color_mapping <- setNames(use_colors[1:length(unique_uses)], unique_uses)
data$UseColor <- use_color_mapping[data$Uses]

# Plot the chord diagram with uniform colors for each use
chordDiagram(data, annotationTrack = "grid", preAllocateTracks = 1, col = data$UseColor)
circos.trackPlotRegion(track.index = 1, panel.fun = function(x, y) {
  xlim = get.cell.meta.data("xlim")
  ylim = get.cell.meta.data("ylim")
  sector.name = get.cell.meta.data("sector.index")
  circos.text(mean(xlim), ylim[1] + .1, sector.name, facing = "clockwise", niceFacing = TRUE, adj = c(0, 0.5), cex = 0.6) # Adjust the font size with the 'cex' parameter
  circos.axis(h = "top", labels.cex = 0.5, major.tick.length = 0.2, sector.index = sector.name, track.index = 2)
}, bg.border = NA)


library(tidyverse)
